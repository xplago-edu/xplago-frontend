var p=Object.defineProperty;var g=(n,t,e)=>t in n?p(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var r=(n,t,e)=>g(n,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const m of o.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&i(m)}).observe(document,{childList:!0,subtree:!0});function e(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=e(s);fetch(s.href,o)}})();const a="/xplago-frontend/";class l{}r(l,"Home",{name:"home",ref:a}),r(l,"Shop",{name:"shop",ref:a+"shop/index.html"}),r(l,"Sale",{name:"sale",ref:a+"sale/index.html"}),r(l,"Blog",{name:"blog",ref:a+"blog/index.html"});function f(n){if(C(n)){const t=E(n);if(t!=null)return t.classList.add("active"),!0;console.error("Cannot find link element by "+n)}return!1}function E(n){return document.getElementById("navigation-"+n.name)}function C(n){return window.location.pathname.includes(n.ref)}class v{constructor(t){r(this,"successor",null);this.action=t}execute(){var e;const t=this.action();return t||(((e=this.successor)==null?void 0:e.execute())??!1)}}class P{constructor(){r(this,"startElement",null);r(this,"currentElement",null)}add(t){return this.addElement(new v(()=>f(t)))}addElement(t){return this.startElement==null||this.currentElement==null?(this.startElement=t,this.currentElement=t):(this.currentElement.successor=t,this.currentElement=t),this}execute(){if(this.startElement==null)throw new Error("Chain is empty");return this.startElement.execute()}}new P().add(l.Shop).add(l.Sale).add(l.Blog).add(l.Home).execute();const y=Date.now();addEventListener("load",n=>{const t=Date.now()-y;I(t)});function I(n){const t=S();t!=null&&(t.textContent="Site was loaded by "+n+" ms")}function S(){return document.getElementById("loading-time-box-content")}function b(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,n=>(+n^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+n/4).toString(16))}class c{constructor(){r(this,"elementId");r(this,"parent",null);r(this,"children",[]);r(this,"isComposeElement",!1);r(this,"parentElement",null);this.elementId=b()}renderAll(t){this.parentElement=t,console.log(t);const e=this.compose();e&&t.appendChild(e)}addChild(t){return t.parent=this,this.children.push(t),this}compose(){var e;if(!this.isComposeElement)this.isComposeElement=!0;else{const i=document.documentElement.querySelectorAll(`[elementId="${this.elementId}"]`);(e=i[0].parentElement)==null||e.removeChild(i[0])}const t=this.render();if(t==null)return null;t.setAttribute("elementId",this.elementId);for(const i of this.children){const s=i.render();s!=null&&t.appendChild(s)}return t}setState(t){t(),this.reRender()}reRender(){this.isComposeElement&&this.parentElement!=null&&this.renderAll(this.parentElement),this.parent!=null&&this.parent.reRender()}static createElement(t){const e=document.createElement("div");return e.innerHTML=t,e.firstElementChild}}class w{constructor(){r(this,"cartPositionItemsKey","cartPositionItems")}getPositionItems(){const t=localStorage.getItem(this.cartPositionItemsKey);return t==null?[]:JSON.parse(t)}setPositionItems(t){const e=JSON.stringify(t);localStorage.setItem(this.cartPositionItemsKey,e)}}class x{constructor(){r(this,"storage",new w);r(this,"countCallbacks",[])}getItems(){return this.storage.getPositionItems()}addPosition(t){const e=this.storage.getPositionItems();let i=null;for(const s of e)s.position.id==t.id&&(s.quantity+=1,i=s);return i==null&&(i={position:t,quantity:1},e.push(i)),this.storage.setPositionItems(e),this.onCountChange(),i}removePosition(t){const e=this.storage.getPositionItems();let i=null;for(let s=0;s<e.length;s++){const o=e[s];o.position.id==t.id&&(o.quantity-=1,o.quantity==0?e.splice(s,1):i=o)}return this.storage.setPositionItems(e),this.onCountChange(),i}getItemByPosition(t){const e=this.storage.getPositionItems();let i=null;for(const s of e)s.position.id==t.id&&(i=s);return i}getPositionsCount(){return this.storage.getPositionItems().length}registerOnCountChangeCallback(t){this.countCallbacks.push(t)}onCountChange(){const t=this.getPositionsCount();for(const e of this.countCallbacks)e(t)}}class L{getPublicPositions(){return[{id:"1",name:"Jeans Jacket",price:199,imageUrl:a+"/assets/promo/7.avif"},{id:"2",name:"Shirt",price:99,imageUrl:a+"/assets/promo/6.avif"},{id:"3",name:"Gray Sweater",price:169,imageUrl:a+"/assets/promo/5.avif"},{id:"4",name:"Cardigan",price:199,imageUrl:a+"/assets/promo/4.avif"},{id:"5",name:"Coat",price:499,imageUrl:a+"/assets/promo/3.avif"},{id:"6",name:"Blazer",price:299,imageUrl:a+"/assets/promo/2.avif"}]}}class B{constructor(){r(this,"url","https://randomuser.me/api/")}async getUser(){const t=await fetch(this.url);return t.ok?(await t.json()).results[0]:null}}const u=new x,k=new L,$=new B;class A extends c{constructor(e){super();r(this,"cartService");r(this,"count");this.cartService=e,this.count=this.cartService.getPositionsCount(),this.cartService.registerOnCountChangeCallback(i=>this.onCountChange(i))}onCountChange(e){this.setState(()=>{this.count=e})}render(){return c.createElement(this.getElementHtml(this.count))}getElementHtml(e){return`<span>${e}</span>`}}const d=document.getElementById("cart-counter-button");d&&new A(u).renderAll(d);class H extends c{constructor(e,i,s){super();r(this,"cartService");r(this,"item",null);this.parent=s,this.cartService=i,this.item=e}addPosition(){this.setState(()=>{this.item!=null&&(this.item=this.cartService.addPosition(this.item.position))})}removePosition(){this.setState(()=>{this.item!=null&&(this.item=this.cartService.removePosition(this.item.position))})}render(){return this.getElement()}getElement(){if(this.item==null)return null;const e=c.createElement(this.getCartElementHtml(this.item));return e.getElementsByClassName("add")[0].addEventListener("click",()=>{this.addPosition()}),e.getElementsByClassName("remove")[0].addEventListener("click",()=>{this.removePosition()}),e}getCartElementHtml(e){return`
        <li class="cart__wrapper__list-item">
            <img src="${e.position.imageUrl}" alt="4">
            <h3>${e.position.name}</h3>
            <p>${e.position.price}$</p>
            <button class="pressable white-light remove">
                <img src="${a}assets/icons/minus-light.svg" alt="add to cart">
            </button>
            <span>${e.quantity}</span>
            <button class="pressable white-light add">
                <img src="${a}assets/icons/plus-light.svg" alt="add to cart">
            </button>
        </li>`}}class _ extends c{constructor(){super()}render(){return c.createElement(this.getElementHtml())}getElementHtml(){return'<ul class="cart__wrapper__list" id="cart-positions-list"></ul>'}}const O=u.getItems(),h=document.getElementsByClassName("cart__wrapper")[0];if(h){const n=new _;for(const t of O)n.addChild(new H(t,u,n));n.renderAll(h)}export{c as A,a as b,u as c,k as p,$ as u};
